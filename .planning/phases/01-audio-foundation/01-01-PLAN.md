---
phase: 01-audio-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - forge.config.ts
  - vite.main.config.ts
  - vite.preload.config.ts
  - vite.renderer.config.ts
  - tsconfig.json
  - tailwind.config.ts
  - eslint.config.mjs
  - .prettierrc
  - .gitignore
  - .git/hooks/pre-commit
  - src/main/main.ts
  - src/main/preload.ts
  - src/renderer/index.html
  - src/renderer/index.css
  - src/renderer/main.tsx
autonomous: true
requirements:
  - AUDIO-04

must_haves:
  truths:
    - "User launches the Electron app and sees a window with frameless title bar"
    - "App remembers window position and size between launches"
    - "Dev tools open with Cmd+Opt+I"
    - "Pre-commit hook runs typecheck and lint"
  artifacts:
    - path: "package.json"
      provides: "Project dependencies and scripts"
      contains: "electron-forge"
    - path: "src/main/main.ts"
      provides: "Electron main process with frameless window, autoplay policy, window state"
      min_lines: 40
    - path: "src/main/preload.ts"
      provides: "contextBridge IPC surface"
      min_lines: 5
    - path: "src/renderer/index.html"
      provides: "Renderer entry HTML"
    - path: "src/renderer/main.tsx"
      provides: "React renderer entry point"
    - path: "forge.config.ts"
      provides: "Electron Forge configuration with Vite plugin"
  key_links:
    - from: "src/main/main.ts"
      to: "src/main/preload.ts"
      via: "webPreferences.preload path"
      pattern: "preload.*join"
    - from: "src/main/main.ts"
      to: "electron-window-state"
      via: "windowStateKeeper import"
      pattern: "windowStateKeeper"
    - from: "src/renderer/index.html"
      to: "src/renderer/main.tsx"
      via: "script tag"
      pattern: "script.*src"
---

<objective>
Scaffold the Electron app with Forge + Vite + React + TypeScript + Tailwind and configure the main process with frameless window, window state persistence, autoplay policy, and pre-commit hooks.

Purpose: Establish the entire project foundation -- build tooling, linting, formatting, Electron shell, and developer guardrails -- so all subsequent plans have a working app to build on.
Output: A launchable Electron app with blank React renderer, frameless window, and developer tooling.
</objective>

<execution_context>
@/Users/aharbuz/.claude/get-shit-done/workflows/execute-plan.md
@/Users/aharbuz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-audio-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Scaffold Electron Forge project with React + TypeScript + Tailwind + linting</name>
  <files>
    package.json
    forge.config.ts
    vite.main.config.ts
    vite.preload.config.ts
    vite.renderer.config.ts
    tsconfig.json
    tailwind.config.ts
    eslint.config.mjs
    .prettierrc
    .gitignore
    src/renderer/index.html
    src/renderer/index.css
    src/renderer/main.tsx
  </files>
  <action>
    IMPORTANT: Use Context7 MCP to pull latest Electron Forge docs (especially Vite plugin config and React+TypeScript integration guide) BEFORE scaffolding.

    1. Scaffold with `npx create-electron-app@latest . --template=vite-typescript` (run in the schmidi project directory).
    2. Install React: `npm install react react-dom zustand electron-window-state @electron-toolkit/preload` and `npm install -D @types/react @types/react-dom`.
    3. Install Tailwind: `npm install -D tailwindcss @tailwindcss/vite`. Add the Tailwind Vite plugin to vite.renderer.config.ts. Create src/renderer/index.css with `@import "tailwindcss"`.
    4. Install linting: `npm install -D eslint @typescript-eslint/parser @typescript-eslint/eslint-plugin prettier eslint-config-prettier`. Create eslint.config.mjs (flat config) with TypeScript and Prettier rules. Create .prettierrc with singleQuote: true, semi: true, printWidth: 100.
    5. Update tsconfig.json: set `"jsx": "react-jsx"`, `"strict": true`, `"esModuleInterop": true`, `"moduleResolution": "bundler"`. Ensure paths include src/renderer, src/main, src/shared.
    6. Convert renderer entry point to React: create src/renderer/main.tsx that imports React, ReactDOM, and renders a placeholder `<App />` component. Update index.html to reference main.tsx.
    7. Update .gitignore: add node_modules, out, .vite, dist, .env, do-work/, .DS_Store.
    8. Pin @electron-forge/plugin-vite to exact version in package.json (not range) per research pitfall #4.

    Verify build works: `npm run make` or at minimum `npx tsc --noEmit` should pass.
  </action>
  <verify>
    Run `npx tsc --noEmit` -- must pass with zero errors.
    Run `npx eslint src/ --max-warnings=0` -- must pass.
    Run `npm start` -- Electron window must open (can be blank/placeholder content).
  </verify>
  <done>
    Project scaffolded with all dependencies installed. TypeScript compiles. ESLint passes. Electron app launches with a blank React renderer.
  </done>
</task>

<task type="auto">
  <name>Task 2: Configure Electron main process + preload + pre-commit hook</name>
  <files>
    src/main/main.ts
    src/main/preload.ts
    .git/hooks/pre-commit
  </files>
  <action>
    IMPORTANT: Use Context7 MCP to pull latest Electron docs (BrowserWindow, frameless window, custom title bar, autoplay policy) BEFORE implementation.

    1. Configure src/main/main.ts:
       - Import and use `electron-window-state` (windowStateKeeper) to persist window bounds between launches. Default: 1000x700.
       - Set `app.commandLine.appendSwitch('autoplay-policy', 'no-user-gesture-required')` before app.whenReady().
       - Create BrowserWindow with: minWidth: 800, minHeight: 500, titleBarStyle: 'hidden' (macOS), trafficLightPosition: { x: 12, y: 12 }, webPreferences: { preload: path to preload.js, contextIsolation: true, nodeIntegration: false, sandbox: true }.
       - Call `mainWindowState.manage(win)` to auto-save window bounds.
       - Register Cmd+Opt+I (macOS) / Ctrl+Shift+I (other) to toggle dev tools (hidden by default).
       - On 'window-all-closed', quit app (macOS included for simplicity in dev).
       - Load the renderer URL (Forge provides MAIN_WINDOW_VITE_DEV_SERVER_URL and MAIN_WINDOW_VITE_NAME).

    2. Configure src/main/preload.ts:
       - Use contextBridge to expose a minimal `schmidiAPI` object to the renderer.
       - Expose: `platform` (process.platform), `getAppVersion` (returns app version string via ipcRenderer.invoke).
       - Keep it minimal -- audio engine runs entirely in renderer (Web Audio API). No audio IPC needed.

    3. Create .git/hooks/pre-commit (executable bash script):
       - Run `npx tsc --noEmit` (typecheck).
       - Run `npx eslint src/ --max-warnings=0` (lint).
       - Exit with failure code if either fails.
       - Make the hook executable: `chmod +x .git/hooks/pre-commit`.

    4. Set up native Electron Menu in main.ts: default macOS menu (app name, Edit, Window, Help). No custom menu items needed for Phase 1.
  </action>
  <verify>
    Run `npm start` -- app must launch with frameless window on macOS, traffic lights visible.
    Close and relaunch -- window should restore to same position and size.
    Run `git commit --allow-empty -m "test hook"` -- pre-commit hook should run typecheck + lint.
    Press Cmd+Opt+I -- dev tools should toggle.
  </verify>
  <done>
    Main process configured with frameless window, window state persistence, autoplay policy, preload with IPC bridge, and working pre-commit hook.
  </done>
</task>

</tasks>

<verification>
1. `npm start` launches the Electron app with a frameless window
2. Window remembers position/size across restarts
3. `npx tsc --noEmit` passes
4. `npx eslint src/ --max-warnings=0` passes
5. Pre-commit hook blocks commits with type errors or lint issues
6. Dev tools toggle with Cmd+Opt+I
</verification>

<success_criteria>
A launchable Electron app with React renderer, frameless window, window state persistence, autoplay policy, TypeScript strict mode, Tailwind CSS, ESLint + Prettier, and a pre-commit hook that enforces typecheck + lint.
</success_criteria>

<output>
After completion, create `.planning/phases/01-audio-foundation/01-01-SUMMARY.md`
</output>
